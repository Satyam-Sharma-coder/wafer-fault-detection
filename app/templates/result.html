<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Fault Detection Results</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, Arial;
      background-color: #f8f9fa;
    }

    .card {
      border-radius: 12px;
    }

    .metric-card h6 {
      color: #6c757d;
      margin-bottom: 6px;
    }

    .metric-card h3 {
      font-weight: 700;
    }

    .table thead {
      background-color: #343a40;
      color: white;
    }

    .badge-low { background-color: #ffc107; }
    .badge-medium { background-color: #fd7e14; }
    .badge-high { background-color: #dc3545; }
    .badge-normal { background-color: #198754; }
  </style>
</head>

<body>

<div class="container py-5">

  <!-- Page Title -->
  <div class="text-center mb-4">
    <h2 class="fw-bold">Fault Detection Results</h2>
    <p class="text-muted">Autoencoder-based Normal Behaviour Modelling</p>
  </div>

  <!-- Summary Cards -->
  <div class="row text-center mb-4">

    <div class="col-md-4">
      <div class="card shadow-sm metric-card">
        <div class="card-body">
          <h6>Total Wafers</h6>
          <h3>{{ total }}</h3>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card shadow-sm metric-card">
        <div class="card-body">
          <h6>Faulty Detected</h6>
          <h3 class="text-danger">{{ faulty }}</h3>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card shadow-sm metric-card">
        <div class="card-body">
          <h6>Threshold</h6>
          <h3>{{ threshold }}</h3>
        </div>
      </div>
    </div>

  </div>

  <!-- Metrics Table -->
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-primary text-white">
      Unsupervised Metrics
    </div>
    <div class="card-body">
      <table class="table table-bordered text-center align-middle">
        <thead>
          <tr>
            <th>Metric</th>
            <th>Value</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Precision</td>
            <td>{{ precision }}</td>
          </tr>
          <tr>
            <td>Recall</td>
            <td>{{ recall }}</td>
          </tr>
          <tr>
            <td>F1-Score</td>
            <td>{{ f1 }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Severity Table -->
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-warning">
      Severity Breakdown
    </div>
    <div class="card-body">
      <table class="table table-bordered text-center align-middle">
        <thead>
          <tr>
            <th>Severity Level</th>
            <th>Count</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <span class="badge badge-normal">Normal</span>
            </td>
            <td>{{ severity.Normal }}</td>
          </tr>
          <tr>
            <td>
              <span class="badge badge-low">Low</span>
            </td>
            <td>{{ severity.Low }}</td>
          </tr>
          <tr>
            <td>
              <span class="badge badge-medium">Medium</span>
            </td>
            <td>{{ severity.Medium }}</td>
          </tr>
          <tr>
            <td>
              <span class="badge badge-high">High</span>
            </td>
            <td>{{ severity.High }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Plots (Interpretability Section) -->
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-secondary text-white">
      Reconstruction Error Distribution
    </div>
    <div class="card-body text-center">
      <img src="{{ error_plot }}" class="img-fluid rounded shadow-sm">
    </div>
  </div>

  <div class="card shadow-sm mb-4">
    <div class="card-header bg-secondary text-white">
      Confusion Matrix
    </div>
    <div class="card-body text-center">
      <img src="{{ cm_plot }}" class="img-fluid rounded shadow-sm">
    </div>
  </div>

  <!-- Navigation -->
  <div class="text-center mt-4">
    <a href="/" class="btn btn-outline-primary">
      Back to Home
    </a>
  </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
